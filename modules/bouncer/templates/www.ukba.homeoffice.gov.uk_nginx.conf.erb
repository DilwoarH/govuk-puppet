upstream ukba {
  server origin.ukba.homeoffice.gov.uk:80;
}

server {
  server_name www.ukba.homeoffice.gov.uk;
  server_name aka.ukba.homeoffice.gov.uk;
  server_name bia.homeoffice.gov.uk;
  server_name aka-bia.homeoffice.gov.uk;
  server_name ind.homeoffice.gov.uk;
  server_name aka-ind.homeoffice.gov.uk;
  server_name origin.ukba.homeoffice.gov.uk;
  server_name aka-origin.ukba.homeoffice.gov.uk;
  server_name ukba.homeoffice.gov.uk;
  server_name aka-ukba.homeoffice.gov.uk;
  server_name www.bia.homeoffice.gov.uk;
  server_name aka.bia.homeoffice.gov.uk;
  server_name www.ind.homeoffice.gov.uk;
  server_name aka.ind.homeoffice.gov.uk;
  listen 80;

  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header X-Forwarded-Server $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_connect_timeout 10s;
  proxy_read_timeout 15s; # /view/case_finder.form is often quite slow.

  access_log /var/log/nginx/www.ukba.homeoffice.gov.uk-access.log timed_combined;
  access_log /var/log/nginx/www.ukba.homeoffice.gov.uk-json.event.access.log json_event;
  error_log /var/log/nginx/www.ukba.homeoffice.gov.uk-error.log;

  location /aboutus/informationformps {
    proxy_pass http://ukba;
    # Can't use $http_host as that might be eg aka.ukba.homeoffice.gov.uk
    proxy_set_header Host www.ukba.homeoffice.gov.uk;
  }

  location /view/case_finder.form {
    proxy_pass http://ukba;
    # Can't use $http_host as that might be eg aka.ukba.homeoffice.gov.uk
    proxy_set_header Host www.ukba.homeoffice.gov.uk;
  }

  location /visas-immigration/general-info/processing-times {
    proxy_pass http://ukba;
    # Can't use $http_host as that might be eg aka.ukba.homeoffice.gov.uk
    proxy_set_header Host www.ukba.homeoffice.gov.uk;
  }

  location /visas-immigration/general-info/fees {
    proxy_pass http://ukba;
    # Can't use $http_host as that might be eg aka.ukba.homeoffice.gov.uk
    proxy_set_header Host www.ukba.homeoffice.gov.uk;
  }

  location ~ (/static/biaAssets/*|/images/*) {
    proxy_pass http://ukba;
    # Can't use $http_host as that might be eg aka.ukba.homeoffice.gov.uk
    proxy_set_header Host www.ukba.homeoffice.gov.uk;
  }

  # Fall back to Bouncer
  location / {
    proxy_pass http://<%= "bouncer.#{@app_domain}-proxy" %>;
    proxy_set_header Host $http_host;
  }
}
