---
- scm:
    name: env-sync-and-backup_Copy_Whitehall_DB_to_preview
    scm:
        - git:
            url: git@github.gds:gds/env-sync-and-backup.git
            branches:
              - master

- job:
    name: Copy_Whitehall_DB_to_preview
    display-name: Copy_Whitehall_DB_to_preview
    project-type: freestyle
    description: "This job copies the sanitised whitehall_production MySQL Database dump file from Production to Preview."
    properties:
        - github:
            url: https://github.gds/gds/env-sync-and-backup/
    scm:
      - env-sync-and-backup_Copy_Whitehall_DB_to_preview
    logrotate:
        artifactNumToKeep: 10
    triggers:
        - timed: '15 5 * * 1-5'
    builders:
        - shell: |
            cd "$WORKSPACE/whitehall/"
            echo "Sanitising Whitehall DB"
            ./sanitise-db.sh "<%= @whitehall_mysql_password %>"
    wrappers:
        - ansicolor:
            colormap: xterm
