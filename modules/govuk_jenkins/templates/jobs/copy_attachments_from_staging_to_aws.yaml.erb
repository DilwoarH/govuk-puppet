---
- scm:
    name: env-sync-and-backup_Copy_Attachments_from_Staging_to_AWS
    scm:
        - git:
            url: git@github.com:alphagov/env-sync-and-backup.git
            branches:
              - master

- job:
    name: Copy_Attachments_from_Staging_to_AWS
    display-name: Copy_Attachments_from_Staging_to_AWS
    project-type: freestyle
    description: |
        This job copies assets attachments from Staging to AWS.
    properties:
        - github:
            url: https://github.com/alphagov/env-sync-and-backup/
        - inject:
            properties-content: |
              PARALLEL_JOBS=1
    scm:
      - env-sync-and-backup_Copy_Attachments_from_Staging_to_AWS
    logrotate:
        numToKeep: 10
    builders:
        - shell: |
            set -eu

            cd "${WORKSPACE}"

            echo "Syncing data"
            export JOBLIST=attachments
            bash sync staging integration
    wrappers:
        - ansicolor:
            colormap: xterm
    parameters:
        - choice:
            name: JOBLIST
            description: 'Choose the thing to sync. All is the default, but some jobs may run but not do anything due to your config for the destination environment.'
            choices:
                - attachments
