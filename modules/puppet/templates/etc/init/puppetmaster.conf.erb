# Puppet Master

description     "puppet master"

start on runlevel [2345]
stop on runlevel [!2345]

env PIDFILE=/var/run/puppetmaster/puppet-unicorn.pid
env CMD="unicornherder -u unicorn -p $PIDFILE -- -p <%= @unicorn_port %> -c /etc/puppet/unicorn.conf"

respawn
respawn limit 7 20

exec start-stop-daemon --start \
                       --chuid 'puppet:puppet' \
                       --chdir '/etc/puppet' \
                       --pidfile $PIDFILE \
                       --startas '/bin/sh' \
                       -- -c "exec $CMD"
