[main]
preferred_serialization_format = yaml
pluginsync = true
lastrunfile = $statedir/last_run_summary.yaml { mode = 644 }
environment = <%= scope.lookupvar("::environment") %>
<%- if govuk_platform == 'development' -%>
modulepath = /var/govuk/puppet/modules:/var/govuk/puppet/vendor/modules
manifestdir = /var/govuk/puppet/manifests
<%- end -%>

[master]
reports = store
storeconfigs = true
storeconfigs_backend = puppetdb
<%- if govuk_platform != 'development' -%>
modulepath = /usr/share/puppet/production/current/modules:/usr/share/puppet/production/current/vendor/modules
manifestdir = /usr/share/puppet/production/current/manifests
<%- end -%>

[agent]
report = false
configtimeout = 600
postrun_command = /usr/local/bin/puppet_passive_check_update
