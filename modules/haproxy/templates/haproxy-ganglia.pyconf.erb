modules {
    module {
        name = "haproxy"
        language = "python"
        param socket_timeout {
        	value = 15
        }
        param stats_socket {
            value = '/var/run/haproxy.sock'
        }
        param services {
            value = '<%= @lb_name %>'
        }
        param groups {
            value = 'haproxy'
        }
    }
}
collection_group {
    collect_every = 60
    time_threshold = 180
    metric {
        name = "<%= @lb_name %>_scur"
        title = "<%= @lb_name %> Current Sessions"
        value_threshold = 10
    }
    metric {
        name = "<%= @lb_name %>_rate"
        title = "<%= @lb_name %> Current Session Rate"
        value_threshold = 10
    }
    metric {
        name = "<%= @lb_name %>_rate_max"
        title = "<%= @lb_name %> Max Session Rate"
        value_threshold = 10
    }
    metric {
        name = "<%= @lb_name %>_hrsp_1xx"
        title = "<%= @lb_name %> Rsps 1xx"
        value_threshold = 100
    }
    metric {
        name = "<%= @lb_name %>_hrsp_2xx"
        title = "<%= @lb_name %> Rsps 2xx"
        value_threshold = 1000
    }
    metric {
        name = "<%= @lb_name %>_hrsp_3xx"
        title = "<%= @lb_name %> Rsps 3xx"
        value_threshold = 1000
    }
    metric {
        name = "<%= @lb_name %>_hrsp_4xx"
        title = "<%= @lb_name %> Rsps 4xx"
        value_threshold = 1000
    }
    metric {
        name = "<%= @lb_name %>_hrsp_5xx"
        title = "<%= @lb_name %> Rsps 5xx"
        value_threshold = 10
    }
    metric {
        name = "<%= @lb_name %>_hrsp_other"
        title = "<%= @lb_name %> Rsps other"
        value_threshold = 10
    }
}
