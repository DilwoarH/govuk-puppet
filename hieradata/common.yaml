---
HIERA_SAFETY_CHECK: true

app_domain: 'dev.gov.uk'

apt::apt_update_frequency: 'daily'
apt::purge_preferences_d: true
apt::purge_sources_list: true
apt::purge_sources_list_d: true
apt::sources:
  ubuntu:
    include_src: false
    location: 'http://gb.archive.ubuntu.com/ubuntu/'
    release: '%{::lsbdistcodename}'
    repos: 'main restricted universe multiverse'
  ubuntu-updates:
    include_src: false
    location: 'http://gb.archive.ubuntu.com/ubuntu/'
    release: '%{::lsbdistcodename}-updates'
    repos: 'main restricted universe multiverse'
  ubuntu-backports:
    include_src: false
    location: 'http://gb.archive.ubuntu.com/ubuntu/'
    release: '%{::lsbdistcodename}-backports'
    repos: 'main restricted universe multiverse'
  ubuntu-security:
    include_src: false
    location: 'http://gb.archive.ubuntu.com/ubuntu/'
    release: '%{::lsbdistcodename}-security'
    repos: 'main restricted universe multiverse'
apt::unattended_upgrades::blacklist:
 - 'mysql-server.*'
apt::unattended_upgrades::mail_to: 'machine.email@digital.cabinet-office.gov.uk'
apt::unattended_upgrades::origins:
 - "%{::lsbdistid} stable"
 - "%{::lsbdistid} %{::lsbdistcodename}-security"

_: &offsite_gpg_key '13B84C37AB52D76B3F53CF0E7C34BD7A05119BA4'
_: &offsite_host 'backup0.backup.provider1.production.govuk.service.gov.uk'
_: &offsite_ssh_key 'AAAAB3NzaC1yc2EAAAADAQABAAABAQDR88DkaA+y/fQUYcIN15t/1IpiFf4rCZdoIlXfCiVLE2TaDQY7viH/1y0DV2fQiSUg+17Hz/RK6wKw09V0nPw/edGUYR7kUZ6m1bbNkny/d5YgZLEyrW1to99f2LvsLYRsQJWXSlpi2uYMaScmbDbVZrUoIAovJv2jpBjhXKIVd/NhQ19LTTS2rqSukL+TImQ1+nO26UMLeRoLLDzdboPebR5pVQE0khAZZOnEfD7V5jObqu8VlO7U/xHaC5M4tz9CNmk1nhMgZtHQd5hLANCx1hROWdmJeH7egzPD7d9fBwL2gi2SQXf1LgEub+ZEIVYWSJ+14PqVzuxCTS0aOGmp'

backup::assets::dest_host: *offsite_host
backup::assets::dest_host_key: *offsite_ssh_key
backup::assets::jobs:
  'assets-whitehall':
    sources: '/mnt/uploads/whitehall'
    destination: "rsync://govuk-assets@%{hiera('backup::assets::dest_host')}//srv/backup-assets/whitehall"
    hour: 4
    minute: 20
    user: 'root'
    gpg_key_id: *offsite_gpg_key
  'asset-manager':
    sources: '/mnt/uploads/asset-manager'
    destination: "rsync://govuk-assets@%{hiera('backup::assets::dest_host')}//srv/backup-assets/asset-manager"
    hour: 4
    minute: 13
    user: 'root'
    gpg_key_id: *offsite_gpg_key

backup::offsite::dest_host: *offsite_host
backup::offsite::dest_host_key: *offsite_ssh_key
backup::offsite::jobs:
  'govuk-datastores':
    sources:
      - '/data/backups/*/var/lib/automongodbbackup/latest'
      - '/data/backups/*/var/lib/automysqlbackup/latest.tbz2'
      - '/data/backups/*/var/lib/autopostgresqlbackup/latest.tbz2'
      - '/data/backups/archived'
    destination: "rsync://%{hiera('backup::offsite::dest_host')}//srv/backup-data/"
    hour: 8,
    minute: 13,
    gpg_key_id: *offsite_gpg_key
  'govuk-graphite':
    sources: '/data/backups/*/opt/graphite/storage/whisper'
    destination: "rsync://%{hiera('backup::offsite::dest_host')}//srv/backup-graphite/"
    weekday: 6
    hour: 8,
    minute: 13,
    # No encryption because of size and sensitivity

etcd::peer_heartbeat_interval: 100
etcd::peer_election_timeout: 500

govuk::apps::authenticating_proxy::signon_uri: "https://signon.%{hiera('app_domain')}"
govuk::apps::authenticating_proxy::errbit_uri: "https://errbit.%{hiera('app_domain')}"

govuk::apps::govuk_crawler_worker::airbrake_endpoint: "https://errbit.%{hiera('app_domain')}/notifier_api/v2/notices"

govuk::apps::publishing_api::content_store: "https://content-store.%{hiera('app_domain')}"
govuk::apps::publishing_api::draft_content_store: "https://draft-content-store.%{hiera('app_domain')}"
# FIXME: Remove this once the draft stack has stabilised.
govuk::apps::publishing_api::suppress_draft_store_502_error: '1'

govuk::node::s_backend::apps:
  - govuk::apps::asset_manager
  - govuk::apps::business_support_api
  - govuk::apps::canary_backend
  - govuk::apps::collections_publisher
  - govuk::apps::contacts
  - govuk::apps::content_planner
  - govuk::apps::content_register
  - govuk::apps::contentapi
  - govuk::apps::courts_api
  - govuk::apps::email_alert_api
  - govuk::apps::email_alert_monitor
  - govuk::apps::email_alert_service
  - govuk::apps::event_store
  - govuk::apps::external_link_tracker
  - govuk::apps::frontend
  - govuk::apps::govuk_delivery
  - govuk::apps::hmrc_manuals_api
  - govuk::apps::imminence
  - govuk::apps::kibana
  - govuk::apps::maslow
  - govuk::apps::need_api
  - govuk::apps::panopticon
  - govuk::apps::policy_publisher
  - govuk::apps::publisher
  - govuk::apps::publishing_api
  - govuk::apps::release
  - govuk::apps::search_admin
  - govuk::apps::short_url_manager
  - govuk::apps::sidekiq_monitoring
  - govuk::apps::signon
  - govuk::apps::specialist_publisher
  - govuk::apps::support
  - govuk::apps::support_api
  - govuk::apps::tariff_admin
  - govuk::apps::tariff_api
  - govuk::apps::transition
  - govuk::apps::travel_advice_publisher
  - govuk::apps::url_arbiter

govuk::node::s_frontend::apps:
  - govuk::apps::canary_frontend
  - govuk::apps::collections
  - govuk::apps::contacts
  - govuk::apps::contacts_frontend
  - govuk::apps::courts_frontend
  - govuk::apps::designprinciples
  - govuk::apps::email_alert_frontend
  - govuk::apps::feedback
  - govuk::apps::frontend
  - govuk::apps::government_frontend
  - govuk::apps::info_frontend
  - govuk::apps::manuals_frontend
  - govuk::apps::specialist_frontend
  - govuk::apps::static
  - govuk::apps::transactions_explorer

govuk_cdnlogs::rotate_logs_hourly: ['bouncer']
govuk_cdnlogs::service_port_map:
  govuk: 6514
  assets: 6515
  bouncer: 6516

govuk_crawler::amqp_host: 'rabbitmq-1.backend'
govuk_crawler::govuk_gemfury_source_url: "%{hiera('govuk_gemfury_source_url')}"
govuk_crawler::site_root: 'https://www.gov.uk'

govuk_gemfury_source_url: 'https://BnrJb6FZyzspBboNJzYZ@gem.fury.io/govuk/'

govuk_jenkins::github_enterprise_cert: |
    -----BEGIN CERTIFICATE-----
    MIIEdDCCA1ygAwIBAgIJAKt4YiHj0+tVMA0GCSqGSIb3DQEBBQUAMIGCMQswCQYD
    VQQGEwJHQjEPMA0GA1UECBMGTG9uZG9uMQ8wDQYDVQQHEwZMb25kb24xFzAVBgNV
    BAoTDkNhYmluZXQgT2ZmaWNlMSMwIQYDVQQLExpHb3Zlcm5tZW50IERpZ2l0YWwg
    U2VydmljZTETMBEGA1UEAxMKZ2l0aHViLmdkczAeFw0xMzAxMDcxNTE5MjhaFw0x
    ODAxMDYxNTE5MjhaMIGCMQswCQYDVQQGEwJHQjEPMA0GA1UECBMGTG9uZG9uMQ8w
    DQYDVQQHEwZMb25kb24xFzAVBgNVBAoTDkNhYmluZXQgT2ZmaWNlMSMwIQYDVQQL
    ExpHb3Zlcm5tZW50IERpZ2l0YWwgU2VydmljZTETMBEGA1UEAxMKZ2l0aHViLmdk
    czCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANiLTHwolRWmRZeIeboY
    4L4VUoMv6zg0rovpzX1hdzdJ5Gn6OoxaADO78Al85/9jRXIYyun6d9iRAknb1ZrG
    yxLQ8mmMl8rqbHa/mBK42G5NVL703712NslcNfeY/FvvdtVBjUI1EIRbehDYMYET
    aqX88HAvohyIoe1LJ4+6t2hF+P1dP7DQvxcu4eBlaywssbvt+FVnYIY87X6CdrVe
    bkMWh0C7J32uY4lEyamcl/M//KjJWFDBkFTbdguZW+KeFwfecVh+OpsdNRKzI3vX
    zriHE7icrJWw5jssE2ZMregLfc1bZ5zpPljEFVxDzyIuseUuVxYQSr1GNwrzr1ix
    LIECAwEAAaOB6jCB5zAdBgNVHQ4EFgQUxjT7A9kz7MecUpg6QCMWteDYF7wwgbcG
    A1UdIwSBrzCBrIAUxjT7A9kz7MecUpg6QCMWteDYF7yhgYikgYUwgYIxCzAJBgNV
    BAYTAkdCMQ8wDQYDVQQIEwZMb25kb24xDzANBgNVBAcTBkxvbmRvbjEXMBUGA1UE
    ChMOQ2FiaW5ldCBPZmZpY2UxIzAhBgNVBAsTGkdvdmVybm1lbnQgRGlnaXRhbCBT
    ZXJ2aWNlMRMwEQYDVQQDEwpnaXRodWIuZ2RzggkAq3hiIePT61UwDAYDVR0TBAUw
    AwEB/zANBgkqhkiG9w0BAQUFAAOCAQEASTEwAV+wKUbQcBOKAWsZpPAxw168uRU/
    KVp7XRE7XyOZUPL2OJ9RLRZz1hCgOuwx304DVLfQVeDp+uhsQzmkdxbBto23ejyh
    8gXdHEnbjf2FN1dVomcDo7jqAqBU7Ji/c7sCLU/2z3ILt0fzwrEj3WQOl7dqYxY1
    qruyrjFTQOclWUJKzHqlIKr3iBFVE0Z1EVywWKeV1CwKkikYhTjZGs0goCy0LHrj
    LG8Mr4r1mOsqtUPYYjCN77EOwkRUucvIt1zNPoiD21OXzzxdOIUOUq6l/kERSfba
    LWIWJn/KXkog8bU776IixxWlO8l1TwiCUoDS9YsLIKIRCT74QE48qA==
    -----END CERTIFICATE-----

govuk_mysql::server::expire_log_days: 3

govuk_postgresql::server::configure_env_sync_user: true

govuk_sudo::sudo_conf:
  deploy_init_ctl:
    content: 'deploy ALL=NOPASSWD:/sbin/initctl'
  deploy_service_nginx:
    content: 'deploy ALL=NOPASSWD:/etc/init.d/nginx'
  deploy_service_varnish:
    content: 'deploy ALL=NOPASSWD:/etc/init.d/varnish'
  ubuntu:
    content: 'ubuntu ALL=(ALL) NOPASSWD:ALL'

govuk_unattended_reboot::enabled: true

grub2::recordfail_timeout: 5

hosts::production::ip_api_lb: '10.7.1.2'
hosts::production::ip_backend_lb: '10.3.1.2'
hosts::production::ip_draft_api_lb: '10.7.2.2'
hosts::production::ip_frontend_lb: '10.2.1.2'
hosts::production::ip_licensify_lb: '10.5.1.2'

hosts::production::api::hosts:
  api-1:
    ip: '10.7.0.16'
  api-2:
    ip: '10.7.0.17'
  api-elasticsearch-1:
    ip: '10.7.0.25'
  api-elasticsearch-2:
    ip: '10.7.0.26'
  api-elasticsearch-3:
    ip: '10.7.0.27'
  api-lb-1:
    ip: '10.7.0.101'
  api-lb-2:
    ip: '10.7.0.102'
  api-mongo-1:
    ip: '10.7.0.21'
  api-mongo-2:
    ip: '10.7.0.22'
  api-mongo-3:
    ip: '10.7.0.23'
  api-postgresql-primary-1:
    ip: '10.7.0.40'
  api-postgresql-standby-1:
    ip: '10.7.0.41'
  api-redis-1:
    ip: '10.7.0.29'
  content-store-1:
    ip: '10.7.0.11'
  content-store-2:
    ip: '10.7.0.12'
  content-store-3:
    ip: '10.7.0.13'
  draft-content-store-1:
    ip: '10.7.2.11'
  draft-content-store-2:
    ip: '10.7.2.12'
  search-1:
    ip: '10.7.0.4'
  search-2:
    ip: '10.7.0.5'
  search-3:
    ip: '10.7.0.6'

hosts::production::api::app_hostnames:
  - 'backdrop-read'
  - 'backdrop-write'
  - 'content-store'
  - 'metadata-api'
  - 'rummager'
  - 'search'
  - 'stagecraft'

hosts::production::api::draft_app_hostnames:
  - 'draft-content-store'

hosts::production::backend::hosts:
  asset-master-1:
    ip: '10.3.0.20'
    legacy_aliases:
      - "asset-master-1.%{hiera('app_domain')}"
      - 'asset-master'
      - "asset-master.%{hiera('app_domain')}"
  asset-slave-1:
    ip: '10.3.0.21'
    legacy_aliases:
      - "asset-slave-1.%{hiera('app_domain')}"
      - 'asset-slave'
      - "asset-slave.%{hiera('app_domain')}"
  backend-1:
    ip: '10.3.0.2'
  backend-2:
    ip: '10.3.0.3'
  backend-3:
    ip: '10.3.0.4'
  backend-lb-1:
    ip: '10.3.0.101'
  backend-lb-2:
    ip: '10.3.0.102'
  elasticsearch-1:
    ip: '10.3.0.15'
  elasticsearch-2:
    ip: '10.3.0.16'
  elasticsearch-3:
    ip: '10.3.0.17'
  exception-handler-1:
    ip: '10.3.0.40'
  mapit-server-1:
    ip: '10.3.0.9'
  mapit-server-2:
    ip: '10.3.0.10'
  mongo-1:
    ip: '10.3.0.6'
    # FIXME this legacy alias is now not used anywhere in Puppet
    # However, before it is removed, We'll need to reconfigure
    # the mongo cluster to use the mongo-n.backend
    legacy_aliases:
      - "mongo.backend.%{hiera('internal_tld')}"
      - 'backend-1.mongo'
    service_aliases:
      - 'mongodb'
  mongo-2:
    ip: '10.3.0.7'
    # FIXME this legacy alias is now not used anywhere in Puppet
    # However, before it is removed, We'll need to reconfigure
    # the mongo cluster to use the mongo-n.backend
    legacy_aliases:
      - 'backend-2.mongo'
  mongo-3:
    ip: '10.3.0.8'
    # FIXME this legacy alias is now not used anywhere in Puppet
    # However, before it is removed, We'll need to reconfigure
    # the mongo cluster to use the mongo-n.backend
    legacy_aliases:
      - 'backend-3.mongo'
  mysql-backup-1:
    ip: '10.3.10.2'
    legacy_aliases:
      - 'backup.mysql'
  mysql-master-1:
    ip: '10.3.10.0'
    legacy_aliases:
      - 'master.mysql'
      - "mysql.backend.%{hiera('internal_tld')}"
  mysql-slave-1:
    ip: '10.3.10.1'
    legacy_aliases:
      - 'slave.mysql'
  mysql-slave-2:
    ip: '10.3.10.3'
  performance-backend-1:
    ip: '10.3.0.80'
  performance-backend-2:
    ip: '10.3.0.81'
  postgresql-primary-1:
    ip: '10.3.20.12'
  postgresql-standby-1:
    ip: '10.3.20.13'
  rabbitmq-1:
    ip: '10.3.0.70'
  rabbitmq-2:
    ip: '10.3.0.71'
  rabbitmq-3:
    ip: '10.3.0.72'
  redis-1:
    ip: '10.3.0.50'
  redis-2:
    ip: '10.3.0.51'
  transition-postgresql-master-1:
    ip: '10.3.20.1'
    legacy_aliases:
      - 'transition-master.postgresql'
      - "transition-postgresql.backend.%{hiera('internal_tld')}"
  transition-postgresql-slave-1:
    ip: '10.3.20.2'
    legacy_aliases:
      - 'transition-slave.postgresql'
  whitehall-backend-1:
    ip: '10.3.0.25'
  whitehall-backend-2:
    ip: '10.3.0.26'
  whitehall-backend-3:
    ip: '10.3.0.27'
  whitehall-backend-4:
    ip: '10.3.0.28'
  whitehall-mysql-backup-1:
    ip: '10.3.10.34'
    legacy_aliases:
      - 'whitehall-backup.mysql'
  whitehall-mysql-master-1:
    ip: '10.3.10.30'
    legacy_aliases:
      - 'whitehall-master.mysql'
      - "whitehall-mysql.backend.%{hiera('internal_tld')}"
  whitehall-mysql-slave-1:
    ip: '10.3.10.31'
    legacy_aliases:
      - 'whitehall-slave.mysql'
  whitehall-mysql-slave-2:
    ip: '10.3.10.32'

hosts::production::backend::app_hostnames:
  - 'api-external-link-tracker'
  - 'asset-manager'
  - 'business-support-api'
  - 'canary-backend'
  - 'collections-publisher'
  - 'contacts-admin'
  - 'content-planner'
  - 'content-register'
  - 'contentapi'
  - 'courts-api'
  - 'email-alert-api'
  - 'email-alert-monitor'
  - 'errbit'
  - 'event-store'
  - 'external-link-tracker'
  - 'govuk-delivery'
  - 'hmrc-manuals-api'
  - 'imminence'
  - 'kibana'
  - 'mapit'
  - 'maslow'
  - 'need-api'
  - 'panopticon'
  - 'performanceplatform-admin'
  - 'policy-publisher'
  - 'private-frontend'
  - 'publisher'
  - 'publishing-api'
  - 'search-admin'
  - 'short-url-manager'
  - 'signon'
  - 'specialist-publisher'
  - 'support'
  - 'support-api'
  - 'tariff-admin'
  - 'tariff-api'
  - 'transition'
  - 'travel-advice-publisher'
  - 'url-arbiter'
  - 'whitehall-admin'

hosts::production::frontend::hosts:
  calculators-frontend-1:
    ip: '10.2.0.11'
  calculators-frontend-2:
    ip: '10.2.0.12'
  calculators-frontend-3:
    ip: '10.2.0.13'
  frontend-1:
    ip: '10.2.0.2'
  frontend-2:
    ip: '10.2.0.3'
  frontend-3:
    ip: '10.2.0.4'
  draft-frontend-1:
    ip: '10.2.2.2'
  draft-frontend-2:
    ip: '10.2.2.3'
  performance-frontend-1:
    ip: '10.2.0.20'
  performance-frontend-2:
    ip: '10.2.0.21'
  whitehall-frontend-1:
    ip: '10.2.0.5'
  whitehall-frontend-2:
    ip: '10.2.0.6'
  whitehall-frontend-3:
    ip: '10.2.0.10'
  whitehall-frontend-4:
    ip: '10.2.0.14'
  whitehall-frontend-5:
    ip: '10.2.0.15'
  whitehall-frontend-6:
    ip: '10.2.0.16'
  whitehall-frontend-7:
    ip: '10.2.0.17'
  frontend-lb-1:
    ip: '10.2.0.101'
  frontend-lb-2:
    ip: '10.2.0.102'

hosts::production::frontend::app_hostnames:
  - 'businesssupportfinder'
  - 'calculators'
  - 'calendars'
  - 'canary-frontend'
  - 'collections'
  - 'contacts-frontend'
  - 'contacts-frontend-old'
  - 'courts-frontend'
  - 'designprinciples'
  - 'draft-contacts-frontend'
  - 'draft-government-frontend'
  - 'draft-manuals-frontend'
  - 'draft-static'
  - 'email-alert-frontend'
  - 'feedback'
  - 'finder-frontend'
  - 'frontend'
  - 'government-frontend'
  - 'info-frontend'
  - 'manuals-frontend'
  - 'licencefinder'
  - 'performanceplatform-big-screen-view'
  - 'publicapi'
  - 'public-event-store'
  - 'public-link-tracker'
  - 'service-manual'
  - 'smartanswers'
  - 'spotlight'
  - 'spotlight-proxy'
  - 'specialist-frontend'
  - 'static'
  - 'tariff'
  - 'transactions-explorer'
  - 'whitehall-frontend'

hosts::production::licensify::hosts:
  licensify-frontend-1:
    ip: '10.5.0.2'
  licensify-frontend-2:
    ip: '10.5.0.3'
  licensify-backend-1:
    ip: '10.5.0.4'
  licensify-backend-2:
    ip: '10.5.0.5'
  licensify-mongo-1:
    ip: '10.5.0.6'
  licensify-mongo-2:
    ip: '10.5.0.7'
  licensify-mongo-3:
    ip: '10.5.0.8'
  licensify-lb-1:
    ip: '10.5.0.101'
  licensify-lb-2:
    ip: '10.5.0.102'

hosts::production::licensify::app_hostnames:
  - 'licensify'
  - 'uploadlicence'
  - 'licensify-admin'
  - 'licensing-web-forms'

hosts::production::management::hosts:
  jenkins-1:
    ip: '10.0.0.3'
  puppetmaster-1:
    ip: '10.0.0.5'
    legacy_aliases:
      - 'puppet'
    service_aliases:
      - 'puppet'
      - 'puppetdb'
  monitoring-1:
    ip: '10.0.0.20'
    legacy_aliases:
      - 'monitoring'
      - "nagios.%{hiera('app_domain')}"
    service_aliases:
      - 'alert'
      - 'monitoring'
      - 'nagios'
  graphite-1:
    ip: '10.0.0.22'
    legacy_aliases:
      - "graphite.%{hiera('app_domain')}"
    service_aliases:
      - 'graphite'
  logs-cdn-1:
    ip: '10.0.0.27'
  logging-1:
    ip: '10.0.0.28'
    service_aliases:
      - 'logging'
  logs-elasticsearch-1:
    ip: '10.0.0.29'
    service_aliases:
      - 'logs-elasticsearch'
  logs-elasticsearch-2:
    ip: '10.0.0.30'
  logs-elasticsearch-3:
    ip: '10.0.0.31'
  logs-redis-1:
    ip: '10.0.0.40'
  logs-redis-2:
    ip: '10.0.0.41'
  backup-1:
    ip: '10.0.0.50'
  etcd-1:
    ip: '10.0.0.60'
  etcd-2:
    ip: '10.0.0.61'
  etcd-3:
    ip: '10.0.0.62'
  jumpbox-1:
    ip: '10.0.0.100'
  mirrorer-1:
    ip: '10.0.0.128'
  jumpbox-2:
    ip: '10.0.0.200'

hosts::production::redirector::hosts:
  bouncer-1:
    ip: '10.6.0.4'
  bouncer-2:
    ip: '10.6.0.5'
  bouncer-3:
    ip: '10.6.0.6'

hosts::production::router::hosts:
  cache-1:
    ip: '10.1.0.2'
  cache-2:
    ip: '10.1.0.3'
  cache-3:
    ip: '10.1.0.4'
  draft-cache-1:
    ip: '10.1.2.2'
  draft-cache-2:
    ip: '10.1.2.3'
  router-backend-1:
    ip: '10.1.0.10'
  router-backend-2:
    ip: '10.1.0.11'
  router-backend-3:
    ip: '10.1.0.12'
  cache:
    ip: '10.1.1.1'
    legacy_aliases:
      - 'cache'
      - "www.%{hiera('app_domain')}"
      - "www-origin.%{hiera('app_domain')}"
      - "assets-origin.%{hiera('app_domain')}"
    service_aliases:
      - 'cache'
      - 'router'
  router-backend-internal-lb:
    ip: '10.1.1.2'
    legacy_aliases:
      - "router-api.%{hiera('app_domain')}"
  draft-cache-internal-lb:
    ip: '10.1.2.1'
    legacy_aliases:
      - "draft-router-api.%{hiera('app_domain')}"

internal_tld: 'production'

mongodb::server::version: '2.4.9'

monitoring::checks::smokey::features:
  check_bouncer:
    feature: bouncer
  check_businesssupportfinder:
    feature: businesssupportfinder
  check_calendars:
    feature: calendars
  check_contacts:
    feature: contacts
  check_efg:
    feature: efg
  check_external_link_tracker:
    feature: external_link_tracker
  check_frontend:
    feature: frontend
  check_licencefinder:
    feature: licencefinder
    notes_url: "https://github.gds/pages/gds/opsmanual/2nd-line/nagios.html#licencefinder-smokey-checks"
  check_licensing:
    feature: licensing
  check_publishing:
    feature: mainstream_publishing_tools
  check_router:
    feature: router
  check_search:
    feature: search
  check_signon:
    feature: signon
  check_smartanswers:
    feature: smartanswers
  check_static_mirrors:
    feature: mirror
  check_tariff:
    feature: tariff
  check_whitehall:
    feature: whitehall

nginx::package::version: '1.4.6-1ubuntu3.1'

nodejs::version: '0.10.37-1chl1~%{::lsbdistcodename}1'

ntp::server_list:
  - 'ntp.ubuntu.com'
  - 'time.euro.apple.com'
  - '0.uk.pool.ntp.org'
  - '1.uk.pool.ntp.org'
  - '2.uk.pool.ntp.org'

postgresql::globals::version: '9.3'

rabbitmq::delete_guest_user: true
rabbitmq::config_stomp: true
# Always use our mirror because they only provide the latest package.
rabbitmq::package_ensure: '3.4.3-1'
rabbitmq::manage_repos: false

rcs::fsckfix: 'YES'
rcs::tmptime: '7'

# TODO: These don't work in 2.6.6 so setting to false
# consider changing if we update redis version
redis::conf_aof_rewrite_incremental_fsync: false
redis::conf_hz: false
redis::conf_repl_disable_tcp_nodelay: false
redis::conf_tcp_keepalive: false
# end TODO
# TODO: Replace this with `conf_tcp_keepalive`.
redis::conf_timeout: 300

resolvconf::nameservers:
  - 8.8.8.8
  - 8.8.4.4

# Note: it's important that all targets here have matching host entries both in
# production, and on the dev VM, otherwise nginx will fail to start.
router::assets_origin::asset_routes:
  '/businesssupportfinder/': "businesssupportfinder"
  '/calculators/': "calculators"
  '/calendars/': "calendars"
  '/collections/': "collections"
  '/contacts-assets/': "contacts-frontend-old"
  '/contacts-frontend/': "contacts-frontend"
  '/designprinciples/': "designprinciples"
  '/email-alert-frontend/': "email-alert-frontend"
  '/feedback/': "feedback"
  '/finder-frontend/': "finder-frontend"
  '/frontend/': "frontend"
  '/government/assets/': "whitehall-frontend"
  '/government/placeholder': "whitehall-frontend"
  '/government/uploads/': "whitehall-frontend"
  '/government-frontend/': "government-frontend"
  '/info-frontend/': "info-frontend"
  '/manuals-frontend/': "manuals-frontend"
  '/licencefinder/': "licencefinder"
  '/smartanswers/': "smartanswers"
  '/specialist-frontend/': "specialist-frontend"
  '/spotlight/': "spotlight"
  '/stagecraft/': "stagecraft"
  '/tariff/': "tariff"
  '/transactions-explorer/': "transactions-explorer"

ssh::config::allow_users_enable: true

unattended_reboot::cron_env_vars:
  - 'MAILTO=""'
unattended_reboot::cron_hour: '0-5'
unattended_reboot::etcd_endpoints:
  - "http://etcd-1.management:4001"
  - "http://etcd-2.management:4001"
  - "http://etcd-3.management:4001"

unicornherder::version: '0.0.8'
